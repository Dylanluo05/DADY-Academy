<!DOCTYPE html>
<html>
    <head>
        <link rel="preconnect" href="https://fonts.googleapis.com">
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link href="https://fonts.googleapis.com/css2?family=Oswald&display=swap" rel="stylesheet">
        <link href="https://fonts.googleapis.com/css2?family=Raleway:wght@300&display=swap" rel="stylesheet">
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.1/jquery.min.js"></script>
        <script src = "https://code.jquery.com/ui/1.10.4/jquery-ui.js"></script>
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css">
    </head>
    <style>
        html, body {
            margin: 0;
            padding: 0;
            color: white;
            background-color: #160E2C;
            font-family: 'Raleway', sans-serif;
            overflow-x: hidden;
        }

        h1 {
            font-size: 70px;
            font-weight: lighter;
            color: white;
            transition-duration: 0.4s;
        }

        * {
            box-sizing: border-box;
        }

        #physics-background-1 {
            position: relative;
            background-repeat: no-repeat;
        }

        .physics-background-1-image, .physics-background-1-overlay {
            position: absolute;
            top: 0;
            left: 0;
            bottom: 0;
            right: 0;
        }

        .physics-background-1-image {
            height: 500px;
            background: url("https://images.pexels.com/photos/8472938/pexels-photo-8472938.jpeg?auto=compress&cs=tinysrgb&w=800");
            background-size: cover;
            background-position: center center;
            background-attachment: fixed;
            background-repeat: no-repeat;
            z-index: 1;
        }

        .physics-background-1-overlay {
            height: 500px;
            background-color: black;
            opacity: 0.7;
            z-index: 2;
        }

        .physics-background-1-content {
            height: 500px;
            position: relative;
            z-index: 3;
        }

        #physics-background-2 {
            position: relative;
            background-repeat: no-repeat;
        }

        .physics-background-2-image, .physics-background-2-overlay {
            position: absolute;
            top: 0;
            left: 0;
            bottom: 0;
            right: 0;
        }

        .physics-background-2-image {
            height: 1600px;
            background: url("https://images.pexels.com/photos/6208704/pexels-photo-6208704.jpeg?auto=compress&cs=tinysrgb&w=600");
            background-size: cover;
            background-position: center center;
            background-attachment: fixed;
            background-repeat: no-repeat;
            z-index: 1;
        }

        .physics-background-2-overlay {
            height: 1600px;
            background-color: #282828;
            opacity: 0.7;
            z-index: 2;
        }

        .physics-background-2-content {
            height: 1600px;
            position: relative;
            z-index: 3;
        }

        .physics-transition-background {
            height: 200px;
            background-color: crimson;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        #kinematics-form {
            padding: 20px;
            width: 800px;
            background-color: white;
            display: block;
            margin: auto;
            margin-top: 100px;
            box-shadow: 0 10px 10px 0 rgba(255, 255, 255, 0.7);
        }
        
        label {
            color: white;
            display: block;
            text-align: center;
        }

        p {
            display: inline;
            color: white;
        }

        .kinematics-input {
            display: block;
            margin: auto;
        }

        #calcKinematicsButton {
            height: 30px;
            width: 250px;
            background-color: white;
            border: 2px solid crimson;
            color: crimson;
            display: block;
            margin: auto;
            margin-top: 10px;
            transition-duration: 0.7s;
        }

        #calcKinematicsButton:hover {
            background-color: crimson;
            color: white;
        }

        #kinematics-button:hover {
            background-color: crimson;
            color: white;
        }

        .objectcards {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            align-items: center;
            align-content: center;
        }

        .objectcard {
            margin: 10px;
            padding: 10px;
            border: 1px solid white;
            border-radius: 10px;
            color: white;
            text-align: center;
        }

        table .objectcard {
            width: 100%;
            margin: 0;
            padding: 0;
            border: 0;
            border-radius: 0;
            background-color: #f1f1f1;
            text-align: center;
        }

        .objectcardbutton {
            background-color: crimson;
            color: white;
            border: none;
            margin: 0.5em;
            padding: 0.75em;
            transition-duration: 0.7s;
        }

        .objectcardbutton:hover {
            background-color: #FF3131;
        }

        .objectcardbutton2 {
            background-color: red;
            color: white;
            border: none;
            margin: 0.5em;
            padding: 0.75em;
            transition-duration: 0.7s;
        }

        .objectcardbutton2:hover {
            background-color: orangered;
        }

        .selectedobjectcardbutton {
            border: 1px solid white;
            margin: 0.5em;
            padding: 0.75em;
            background-image: none;
            background-color: #778899;
            color: white;
            cursor: default;
        }

        .maincard {
            width: 45%;
            margin: 10px;
            padding: 2em;
            border: none;
            background-color: transparent;
            border: 2px solid white;
            border-radius: 10px;
        }

        .createcard {
            width: 40%;
            margin: 10px;
            padding: 2em;
            border: 1px solid white;
            border-radius: 10px;
        }

        .maintitle{
            font-size: 20px;
            font-weight: lighter;
            color: white;
        }

        input[type=text] {
            width: 100%;
            padding: 12px 20px;
            margin: 8px 0;
            box-sizing: border-box;
            border: 1px solid white;
            border-radius: 4px;
            background-color: white;
            color: black;
        }

        input[type=text]:focus {
            border: 1px solid white;
        }

        hr.cardhr {
            height:2px;
            border-width:0;
            background-color: white;
        }

    </style>
    <body>
        <div id = "physics-background-1">
            <div class = "physics-background-1-image"></div>
            <div class = "physics-background-1-overlay"></div>
            <div class = "physics-background-1-content">
                <div id = "navbar-content"></div>
                <h1 style = "text-align: center; font-size: 120px; margin-top: 30px;">Physics</h1>
                <h2 style = "text-align: center; font-size: 30px; font-weight: lighter; margin-top: -30px;">Discover why the matter of this world behaves the way it does</h2>
                <div style = "width: 700px; display: block; margin: auto; margin-top: 70px;">
                    <h2 style = "font-size: 21px; font-weight: lighter; text-align: center;">Physics is the study of matter and energy, their fundamental constituents, and their movement and behavior through space and time.</h2>
                </div>
            </div>
        </div>
        <div class = "physics-transition-background">
            <h1>Mechanics</h1>
        </div>
        <div id = "physics-background-2">
            <div class = "physics-background-2-image"></div>
            <div class = "physics-background-2-overlay"></div>
            <div class = "physics-background-2-content">
                <h2 style = "margin: 0; position: relative; top: 50px; text-align: center; font-size: 50px; font-weight: lighter;">Kinematics</h2>
                <div class="objectcards" style = "margin-top: 60px;">
                    <div class="maincard">
                        <h1 class="maintitle" id="mainTitle">No Currently Selected Object</h1>
                        <h3 class="maintitle" id="mainName"></h3>
                        <h3 class="maintitle" id="mainKinematics"></h3>
                        <hr class="cardhr">
                        <h3 class="maintitle"> Calculate Kinematics </h3>
                        <label for = "known-values" style = "margin-top: -15px;">Which values are known?</label>  
                        <div style = "width: 150px; display: block; margin: auto;">
                            <input type = "checkbox" name = "known-values" id = "vi-known" value = "initial-velocity"><p>Initial Velocity</p> 
                        </div>
                        <div style = "width: 150px; display: block; margin: auto;">
                            <input type = "checkbox" name = "known-values" id = "vf-known" value = "final-velocity"><p>Final Velocity</p>
                        </div>
                        <div style = "width: 150px; display: block; margin: auto;">
                            <input type = "checkbox" name = "known-values" id = "a-known" value = "acceleration"><p>Acceleration</p>
                        </div>
                        <div style = "width: 150px; display: block; margin: auto;">
                            <input type = "checkbox" name = "known-values" id = "x-known" value = "displacement"><p>Displacement</p>
                        </div>
                        <div style = "width: 150px; display: block; margin: auto;">
                            <input type = "checkbox" name = "known-values" id = "t-known" value = "time"><p>Time</p>
                        </div>
                        <br>
                        <label for = "initial-velocity-value">What is the value of the initial velocity (If known, otherwise leave blank)</label>
                        <input type = "text" name = "initial-velocity-value" id = "initial-velocity-value" class = "kinematics-input">
                        <label for = "final-velocity-value">What is the value of the final velocity (If known, otherwise leave blank)</label>
                        <input type = "text" name = "final-velocity-value" id = "final-velocity-value" class = "kinematics-input">
                        <label for = "acceleration-value">What is the value of the acceleration (If known, otherwise leave blank)</label>
                        <input type = "text" name = "acceleration-value" id = "acceleration-value" class = "kinematics-input">
                        <label for = "displacement-value">What is the value of the displacement (If known, otherwise leave blank)</label>
                        <input type = "text" name = "displacement-value" id = "displacement-value" class = "kinematics-input">
                        <label for = "time-value">What is the value of the time (If known, otherwise leave blank)</label>
                        <input type = "text" name = "time-value" id = "time-value" class = "kinematics-input">
                        <label for = "unknown-value">What is the value you want to find?</label>
                        <div style = "width: 150px; display: block; margin: auto;">
                            <input type = "radio" name = "unknown-value" id = "initial-velocity-unknown" value = "Initial Velocity"><p>Initial Velocity</p> 
                        </div>
                        <div style = "width: 150px; display: block; margin: auto;">
                            <input type = "radio" name = "unknown-value" id = "final-velocity-unknown" value = "Final Velocity"><p>Final Velocity</p>
                        </div>
                        <div style = "width: 150px; display: block; margin: auto;">
                            <input type = "radio" name = "unknown-value" id = "acceleration-unknown" value = "Acceleration"><p>Acceleration</p>
                        </div>
                        <div style = "width: 150px; display: block; margin: auto;">
                            <input type = "radio" name = "unknown-value" id = "displacement-unknown" value = "Displacement"><p>Displacement</p>
                        </div>
                        <div style = "width: 150px; display: block; margin: auto;">
                            <input type = "radio" name = "unknown-value" id = "time-unknown" value = "Time"><p>Time</p>
                        </div>
                        <input type = "submit" id = "calcKinematicsButton" value = "Calculate">
                        <br>
                    </div>
                </div>
                <br>
                    
                <div class="objectcards" id="cardholder">
                </div>
                <br>
                    
                    
                <div class="objectcards">
                    <div class="createcard">
                        <h1 class="maintitle" style = "color: white">Create an object</h1>
                        <div style="white-space: nowrap;">
                            <input placeholder="Name of object" style="width:65%; display: inline-block;" type="text" id="name-input" name="Object Mass">
                            <button id="createbutton" style="width:33%; display: inline-block;" class="objectcardbutton" onclick="createObj();"> Create  </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <script>
            $(function(){
                $("#navbar-content").load("/DADY-Academy/layouts/navbar.html");
            });

            var url = "https://frq.dtsivkovski.tk/api/physics/kinematics/get/";
            const options = {
                method: 'GET', // *GET, POST, PUT, DELETE, etc.
                mode: 'cors', // no-cors, *cors, same-origin
                cache: 'default', // *default, no-cache, reload, force-cache, only-if-cached
                credentials: 'include', // include, *same-origin, omit
                headers: {
                    'Content-Type': 'application/json',
                },
            };

            var storedinfo;
            var cardholder = document.getElementById("cardholder");
            var mTitle = document.getElementById("mainTitle");
            var mName = document.getElementById("mainName");
            var mKinematics = document.getElementById("mainKinematics");
            var calcKinematicsButton = document.getElementById("calcKinematicsButton");

            function getAllObjects() {
            // fetch the API
                fetch(url, options)
                // response is a RESTful "promise" on any successful fetch
                .then(response => {
                    // check for response errors and display
                    if (response.status !== 200) {
                        const errorMsg = 'Database response error: ' + response.status;
                        console.log(errorMsg);
                        const tr = document.createElement("tr");
                        const td = document.createElement("td");
                        td.innerHTML = errorMsg;
                        tr.appendChild(td);
                        cardholder.appendChild(tr);
                        return;
                    }
                    // valid response will contain json data
                    response.json().then(data => {
                        console.log(data);

                        //remove existing cardholder
                        while(cardholder.firstChild) {
                            cardholder.removeChild(cardholder.firstChild);
                        }

                        for (const row of data) {
                            // create card and give classlist, add to cardholder
                            const card = document.createElement("div");
                            card.classList.add("objectcard");
                            cardholder.appendChild(card);

                            // create elements for card
                            const h3 = document.createElement("h3");
                            h3.innerHTML = "Object #" + row.id + "<br>";
                            const name = document.createElement("p");
                            name.innerHTML = "Name: " + row.name + "<br>";
                            const kinematics = document.createElement("p");
                            kinematics.innerHTML = "Recent Kinematics Calc: " + "<br>" + row.finalAnswer + "<br>";

                            card.appendChild(h3);
                            card.appendChild(name);
                            card.appendChild(kinematics);
                            
                            const buttonholder = document.createElement("div");
                            buttonholder.style.whiteSpace = "nowrap";

                            // create button and give classlist, add to card
                            const button = document.createElement("button");
                            button.classList.add("objectcardbutton");
                            button.style.width = "40%";
                            button.style.display = "inline-block";
                            button.innerHTML = "Select";
                            button.id = "objbutton" + row.id;
                            button.addEventListener("click", function() {
                                selectObj(row.id);
                            });
                            card.appendChild(button);

                            // add deletebutton and give classlist
                            const deletebutton = document.createElement("button");
                            deletebutton.classList.add("objectcardbutton2");
                            deletebutton.innerHTML = "Delete";
                            deletebutton.style.width = "40%";
                            deletebutton.style.display = "inline-block";
                            deletebutton.addEventListener("click", function() {
                                deleteObj(row.id);
                            });
                            card.appendChild(deletebutton);
                        }

                        storedinfo = data;
                    });
                })
            }

            getAllObjects();

            var selectedObj;

            function selectObj(id) {
                console.log("Selected Object - Id: " + id);

                // turn on history delete button when selected obj for first time
                // document.getElementById("clearhistorybutton").style.display = "block";

                // remove selected class from button with selectedObj id
                if (selectedObj != null) {
                    var tempOB = document.getElementById("objbutton" + selectedObj);
                    tempOB.innerHTML = "Select";
                    tempOB.classList.remove("selectedobjectcardbutton");
                    tempOB.classList.add("objectcardbutton");
                }

                // set innerHTML to selected object values using storedinfo
                for (const row of storedinfo) {
                    if (row.id == id) {
                        mTitle.innerHTML = "Object #" + row.id;
                        mName.innerHTML = "Name: " + row.name;
                        mKinematics.innerHTML = "Recent Kinematics Calc: " + row.finalAnswer;

                        var tempOB = document.getElementById("objbutton" + row.id);
                        tempOB.innerHTML = "Selected";
                        tempOB.classList.add("selectedobjectcardbutton");
                        tempOB.classList.remove("objectcardbutton");
                        selectedObj = row.id;

                        // remove old event listener and add new one
                        calcKinematicsButton.onclick = function() {
                            calcKinematics(row.id);
                        };
                    }
                }
            }

            function calcKinematics(id) {
                console.log("Calculating Kinematics for Object - Id: " + id);

                var unknownValue;
                if (document.getElementById("initial-velocity-unknown").checked == true) {
                    unknownValue = document.getElementById("initial-velocity-unknown").value;
                } else if (document.getElementById("final-velocity-unknown").checked == true) {
                    unknownValue = document.getElementById("final-velocity-unknown").value;
                } else if (document.getElementById("acceleration-unknown").checked == true) {
                    unknownValue = document.getElementById("acceleration-unknown").value;
                } else if (document.getElementById("displacement-unknown").checked == true) {
                    unknownValue = document.getElementById("displacement-unknown").value;
                } else if (document.getElementById("time-unknown").checked == true) {
                    unknownValue = document.getElementById("time-unknown").value;
                }

                var viValue;
                var vfValue;
                var aValue;
                var xValue;
                var tValue;

                if (document.getElementById("initial-velocity-value").value == "") {
                    viValue = 0;
                } else {
                    viValue = document.getElementById("initial-velocity-value").value;
                }
                if (document.getElementById("final-velocity-value").value == "") {
                    vfValue = 0;
                } else {
                    vfValue = document.getElementById("final-velocity-value").value;
                }
                if (document.getElementById("acceleration-value").value == "") {
                    aValue = 0;
                } else {
                    aValue = document.getElementById("acceleration-value").value;
                }
                if (document.getElementById("displacement-value").value == "") {
                    xValue = 0;
                } else {
                    xValue = document.getElementById("displacement-value").value;
                }
                if (document.getElementById("time-value").value == "") {
                    tValue = 0;
                } else {
                    tValue = document.getElementById("time-value").value;
                }

                // build url for fetch
                var calcKinematicsurl = "https://frq.dtsivkovski.tk/api/physics/kinematics/calculateKinematics/" + id +  "/" + viValue + "/" + document.getElementById("vi-known").checked + "/" + vfValue + "/" + document.getElementById("vf-known").checked
                + "/" + aValue + "/" + document.getElementById("a-known").checked + "/" + xValue + "/" + document.getElementById("x-known").checked + "/" + tValue + "/" + document.getElementById("t-known").checked + "/" + unknownValue;

                fetch(calcKinematicsurl, options)
                // response is a RESTful "promise" on any successful fetch
                .then(response => {
                    // check for response errors and display
                    if (response.status !== 200) {
                        const errorMsg = 'Database response error: ' + response.status;
                        console.log(errorMsg);
                        return;
                    }
                    // valid response will contain json data
                    response.json().then(data => {
                        console.log(data);
                        mKinematics.innerHTML = "Recent Kinematics Calc: " + data.finalAnswer;
                        getAllObjects();
                        document.getElementById("initial-velocity-value").value = "";
                        document.getElementById("final-velocity-value").value = "";
                        document.getElementById("acceleration-value").value = "";
                        document.getElementById("displacement-value").value = "";
                        document.getElementById("time-value").value = "";
                        });
                });
            }

            function createObj() {
                console.log("Creating Object");

                // build url for fetch
                var createObjurl = "https://frq.dtsivkovski.tk/api/physics/kinematics/create/" + document.getElementById("name-input").value;

                fetch(createObjurl, options)
                // response is a RESTful "promise" on any successful fetch
                .then(response => {
                    // check for response errors and display
                    if (response.status !== 200) {
                        const errorMsg = 'Database response error: ' + response.status;
                        console.log(errorMsg);
                        return;
                    }
                    // valid response will contain json data
                    response.json().then(data => {
                        console.log(data);

                        getAllObjects();
                        selectObj(data.id);
                        });
                });
            }

            function deleteObj(id) {

                if (confirm("Are you sure you want to delete this object?") == false)
                    return;

                console.log("Deleting Object - Id: " + id);

                // build url for fetch
                var deleteObjurl = "https://frq.dtsivkovski.tk/api/physics/kinematics/delete/" + id;

                fetch(deleteObjurl, options)
                // response is a RESTful "promise" on any successful fetch
                .then(response => {
                    // check for response errors and display
                    if (response.status !== 200) {
                        const errorMsg = 'Database response error: ' + response.status;
                        console.log(errorMsg);
                        return;
                    }
                    // valid response will contain json data
                    response.json().then(data => {
                        console.log(data);

                        getAllObjects();
                        selectObj(data[0].id);
                        });
                });
            }

        </script>
    </body>
</html>